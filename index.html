<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="A Not So Very Intelligent Fuzzer: An advanced cross platform fuzzing framework designed to find vulnerabilities in C/C++ code.">
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet2.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark2.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print2.css" media="print">

    <title>ansvif - A Not So Very Intelligent Fuzzer</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>ansvif</h1>
        <center>
        <h2>A Not So Very Intelligent Fuzzer: An advanced cross platform fuzzing framework designed to find vulnerabilities in C/C++ code.</h2>
        <section id="downloads">
          <a href="https://github.com/oxagast/ansvif/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/oxagast/ansvif/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/oxagast/ansvif/releases/download/1.8.1/ansvif-1.8.1-1.fc26.x86_64.rpm" class="btn">1.8.1 Download for Fedora (x86_64)</a>
          <a href="https://github.com/oxagast/ansvif/releases/download/1.8.1/ansvif_1.8-1_amd64.deb" class="btn">1.8.1 Download for Debian (x86_64)</a>
          <a href="https://github.com/oxagast/ansvif/releases/download/1.8.1/ansvif-1.8.1-win10_x86_64.zip" class="btn">1.8.1 Download for Windows (x86_64)</a>
          <a href="https://github.com/oxagast/ansvif" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
        </center>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h3>
<a id="intro" class="anchor" href="#intro" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Intro</h3>

<p><strong>A Not So Very Intelligent Fuzzer</strong></p>
<p>Contact: <a href="mailto:marshall@dont.even.try.to.h4ck.me?Subject=ansvif" target="_top">marshall@dont.even.try.to.h4ck.me</a>
<br>
  If you perfer group discussions, please join ##ansvif on the Freenode IRC network!
  <i>
<br>
<br>
As the complexity of a system rises, as does the potential for problems within that system.
<br>
  --Whittaker's Law
  </i>
<br>
<br>
</p>
<p>
  The fuzzer ansvif is designed to find code bugs by throwing garbage input at programs to see how they react.  This is great for finding bugs, because not every type of input is always handled, and buffers are not always checked, etc.  It also comes in handy when writing (and protecting against), buffer overflow exploitation, as well as string format vulnerabilities (the %s bug).
  For more information, visit the <a href="https://github.com/oxagast/ansvif/wiki">Wiki on GitHub</a>.
</p>
<center>
<iframe width=65%
src="https://www.youtube.com/embed/3HMFBmMLDXE">
</iframe>
</center>
<center><img src="https://raw.githubusercontent.com/oxagast/ansvif/gh-pages/images/ansvif_im.jpg" width=65% height=65%></center>
<center><img src="https://raw.githubusercontent.com/oxagast/ansvif/gh-pages/images/mount_fuzzing_ansvif.png" width=65% height=65%></center>
        </center>
        
        <h3>
<a id="checkout-and-compliation" class="anchor" href="#checkout-and-compliation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Checkout and compliation</h3>
<pre><code>$ git clone https://github.com/oxagast/ansvif
$ cd ansvif
$ aclocal
$ autoconf
$ automake -a
$ ./configure (or) $ ./configure --enable-gtk
$ make
$ make check
</code></pre>

<h3>
<a id="readme" class="anchor" href="#readme" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>README</h3>

<pre><code>
# ansvif
A Not So Very Intelligent Fuzzer.

Compliation:

 Dependancies:
  automake autoconf-archive zlib1g-dev g++ gcc crypto++ (and libgtk2.0-dev if you want the GUI)
  
 Linux:
  $ aclocal && autoconf && automake -a && ./configure && make && make check
  or
  $ aclocal && autoconf && automake -a && ./configure --enable-gtk && make && make check
 OpenBSD:
  $ CXX=$(find / -name 'eg++' 2>/dev/null | grep ports | head -n 1) AUTOCONF_VERSION=2.69 \
    AUTOMAKE_VERSION=1.15 autoreconf -fmi
  $ make check
 Windows:
   Now Windows code is designed to be compiled with MinGW-W64.
  $ ./configure_win
  $ make

  If you would like to try out the example code, you can compile faulty.c with:
  $ gcc faulty.c -o faulty


Using the example code:
  You can point the memory back at address \xff\x05\x40\x00\x00\x00\x00\x00 (the
  subroutine containing the code that spawns bash) with:
  $ ./buffer_overflow -a $(perl -e 'print "A"x24;print "\x00\xff\x05\x40\x00\x00\x00\x00\x00"')
  The address may be a little different under your distro, check gdb if you really
  want to try it out.  The code above /should/ drop you at a bash prompt.
  If the code is set to a mode where all are able to execute as another user, it will
  attempt to spawn a root shell.
  
  Please note that the example faulty buffer_overflow when compiled under Debian 9 does
  not throw an error detectable by ansvif when you fill it with trash.
  Ex:
  $ ./buffer_overflow A AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
  returns 1 with:
  $ echo $?
  This as far as I know is a Debian specific bug.


Useage:
  Important note: Windows users will have to run ansvif.exe from Powershell for it to work!

  $ ./tools/find_suid.sh /usr/bin/ /bin/ /sbin/
  # ./tools/bermise_fuzz.sh nc 127.0.0.1 22 (should be run as root or be able to read /var/log/syslog)
  $ ./ansvif -[tm] [template/manpage] -c /path/to/executable -b buffersize
  $ ./ansvif_gtk -l
  $ ./ansvif_gtk -p /usr/bin/ansvif_gtk

  Examples:
   Linux/BSD:

Fuzzing /bin/mount (a suid 0 process) example:

  $ ./ansvif -m mount -c /bin/mount -e examples/mount_e.txt -x examples/mount_o.txt\
    -f 8 -b 2048

Iceweasel (Firefox) fuzzing example:

  $ ./ansvif -t examples/blank.txt -F tmp/tmphtml -x examples/htmltags.txt -c /usr/bin/iceweasel -b\
    128 -A "file:///home/username/src/ansvif/tmp/tmphtml"  -f 2 -n -R "sleep 3 && killall\
    iceweasel" -S ">"

Syscall fuzzing example:

  $ cat examples/linux_syscalls_implemented.list | xargs -P \
    `cat examples/linux_syscalls_implemented.list | wc -l` -I {calls} ./ansvif -t examples/space.txt \
    -B "{calls} " -c ./syscalls -o syscall_crash -f 1 -z -d -b 16


Windows:

Google Chrome fuzzing example:

  PS C:\ansvif\bin\ansvif_win> .\ansvif -t ..\..\examples\space -F ..\..\tmp\tmphtml -x `
                               ..\..\examples\htmltags -c `
                               'C:\Program Files (x86)\Google\Chrome\Application\chrome.exe' `
                               -b 128 -A "file:///C:\\Users\marsh\OneDrive\Documents\Code\ansvif\tmp\tmphtml" `
                               -f 2 -n -S ">" -R "sleep 2 ; Stop-Process -Name chrome"


Options:
  -t This file should hold line by line command arguments as shown in the example file.
  -e This file should hold line by line environment variables as shown in the example
     file.  You can usually get these by doing something like:
     $ strings /bin/mount | perl -ne 'print if /[A-Z]=$/' > mount_envs
  -c Specifies the command path.
  -p Specifies the manpage location (as an integer, usually 1 or 8)
  -m Specifies the commands manpage.
  -D Dumps whats found in the manpage.
  -f Number of threads to use.  Default is 2.
  -b Specifies the buffer size to fuzz with.  256-2048 Is usually sufficient.
  -r Uses only random garbage data.
  -o Writes output to log file.
  -z Randomize the buffer size from 1 to what is specified by -b.
  -x Other junk to put in.  Usernames and such can go here.
  -S Seperator between options.
  -s Omitted character specification.  Defaults are <>\\n |&\[]\()\{}:;\ and newline is mandatory.
  -T Timeout for threads.
  -W Timeout for threads.
  -L Unpriviledged user to run as if root.
  -A Always put whats after this after command to run.
  -B Always put whats after this before the command to run.
  -F File to feed into the program that -x along with normal fuzzing data will be put in.
  -n Never use random data in the fuzz.
  -R Run this command after each fuzz.
  -C A Non standard error code to detect.
  -V Use Valgrind if installed.
  -1 Try to make it fault once, if it doesn't happen, throw error code 64.  Useful for scripting.
  -P Use % to represent binary in fuzz.
  -M Max arguments to use in the fuzz.
  -y Short for -b 0 and usually only useful with -A or -B.
  -K Keep going after a crash.
  -E A command to be run before the fuzzed progarm.
  -0 No NULL characters in the fuzz.
  -v Verbose.
  -d Debug data.
  -h Shows the help page.

Recommendations:
  DO NOT RUN THIS CODE IN A PRODUCTION ENVIRONMENT!
  If you try setting faulty.c's output to suid(0) then PLEASE do it in a virtual machine.
  or atleast a machine that you don't care about.
  Other than that, just play around and have fun!


Notes:
  Windows users must have ansvif running from Powershell.
  Linux and Windows code should be relatively stable.
</code></pre>

<h3>
<a id="other" class="anchor" href="#other" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Other</h3>

<p>It can be interesting to run things through progarms like radamsa and pipe their output into ansvif.</p>
<p>Syscall fuzzing is only about 20% complete at this time, so it's not ready for use.</p>

<h3>
<a id="authors-and-contributors" class="anchor" href="#authors-and-contributors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authors and Contributors</h3>

<p>Marshall Whittaker (<a href="https://github.com/oxagast" class="user-mention">@oxagast</a>), with some help from other sources such as stackexchanges, IRC, and dll999 for syscall fuzzing ideas.  Thanks!</p>

<h3>
<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>You can contact me at <a href="mailto:marshall@dont.even.try.to.h4ck.me">marshall@dont.even.try.to.h4ck.me</a> and I will try to respond in a timely manner!</p>
      </section>
    </div>

    
  </body>
</html>
